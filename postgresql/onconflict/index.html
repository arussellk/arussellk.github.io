<!doctype html><html lang=en><head><meta charset=utf-8><title>Upsert with ON CONFLICT ... DO UPDATE</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/images/favicon-32.png sizes=32x32><link rel=apple-touch-icon href=/images/favicon-180.png sizes=180x180><link rel=stylesheet href=/css/main.css></head><body><div class=main><p><a href=/>home</a></p><h1>Upsert With on CONFLICT ... DO UPDATE</h1><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#cf222e>create</span><span style=color:#fff> </span><span style=color:#cf222e>table</span><span style=color:#fff> </span><span style=color:#cf222e>if</span><span style=color:#fff> </span><span style=color:#cf222e>not</span><span style=color:#fff> </span><span style=color:#cf222e>exists</span><span style=color:#fff> </span>foo<span style=color:#fff> </span><span style=color:#1f2328>(</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>foo_id<span style=color:#fff> </span><span style=color:#6639ba>serial</span><span style=color:#fff> </span><span style=color:#cf222e>primary</span><span style=color:#fff> </span><span style=color:#cf222e>key</span><span style=color:#1f2328>,</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>col<span style=color:#fff> </span><span style=color:#6639ba>varchar</span><span style=color:#1f2328>(</span><span style=color:#0550ae>50</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>insert</span><span style=color:#fff> </span><span style=color:#cf222e>into</span><span style=color:#fff> </span>foo<span style=color:#fff> </span><span style=color:#1f2328>(</span>foo_id<span style=color:#1f2328>,</span><span style=color:#fff> </span>col<span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>values</span><span style=color:#fff> </span><span style=color:#1f2328>(</span><span style=color:#0550ae>1</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#0a3069>&#39;insert&#39;</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>on</span><span style=color:#fff> </span>conflict<span style=color:#fff> </span><span style=color:#1f2328>(</span>foo_id<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#cf222e>do</span><span style=color:#fff> </span><span style=color:#cf222e>update</span><span style=color:#fff> </span><span style=color:#cf222e>set</span><span style=color:#fff> </span>col<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#0a3069>&#39;upsert&#39;</span><span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span></code></pre></div></div></body></html>