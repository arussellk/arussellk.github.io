<!doctype html><html lang=en><head><meta charset=utf-8><title>Upsert with ON CONFLICT ... DO UPDATE</title>
<meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/images/favicon-32.png sizes=32x32><link rel=apple-touch-icon href=/images/favicon-180.png sizes=180x180><link rel=stylesheet href=/css/main.css></head><body><div class=main><p><a href=/>home</a></p><h1>Upsert With on CONFLICT ... DO UPDATE</h1><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#000;font-weight:700>create</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>table</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>if</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>not</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>exists</span><span style=color:#bbb> </span>foo<span style=color:#bbb> </span>(<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>foo_id<span style=color:#bbb> </span><span style=color:#0086b3>serial</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>primary</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>key</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>col<span style=color:#bbb> </span><span style=color:#0086b3>varchar</span>(<span style=color:#099>50</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>insert</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>into</span><span style=color:#bbb> </span>foo<span style=color:#bbb> </span>(foo_id,<span style=color:#bbb> </span>col)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>values</span><span style=color:#bbb> </span>(<span style=color:#099>1</span>,<span style=color:#bbb> </span><span style=color:#d14>&#39;insert&#39;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#000;font-weight:700>on</span><span style=color:#bbb> </span>conflict<span style=color:#bbb> </span>(foo_id)<span style=color:#bbb> </span><span style=color:#000;font-weight:700>do</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>update</span><span style=color:#bbb> </span><span style=color:#000;font-weight:700>set</span><span style=color:#bbb> </span>col<span style=color:#bbb> </span><span style=color:#000;font-weight:700>=</span><span style=color:#bbb> </span><span style=color:#d14>&#39;upsert&#39;</span>;<span style=color:#bbb>
</span></span></span></code></pre></div></div></body></html>